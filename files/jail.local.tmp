
# http://snippets.aktagon.com/snippets/554-how-to-secure-an-nginx-server-with-fail2ban

[nginx-auth]
enabled = true
filter = nginx-auth
action = iptables-multiport[name=NoAuthFailures, port="http,https"]
logpath = /var/log/nginx/*/*error*.log
# 10 minutes
bantime = 600
maxretry = 6

[nginx-login]
enabled = true
filter = nginx-login
action = iptables-multiport[name=NoLoginFailures, port="http,https"]
logpath = /var/log/nginx/*/*access*.log
# 10 minutes
bantime = 600
maxretry = 6

[nginx-badbots]
enabled  = true
filter = apache-badbots
action = iptables-multiport[name=BadBots, port="http,https"]
logpath = /var/log/nginx/*/*access*.log
# 1 day
bantime = 86400
maxretry = 1

[nginx-noscript]
enabled = true
action = iptables-multiport[name=NoScript, port="http,https"]
filter = nginx-noscript
logpath = /var/log/nginx/*/*access*.log
maxretry = 6
# 1 day
bantime  = 86400

[nginx-proxy]
enabled = true
action = iptables-multiport[name=NoProxy, port="http,https"]
filter = proxy
logpath = /var/log/nginx/*/*access*.log
maxretry = 0
# 1 day
bantime = 86400

# http://serverfault.com/questions/420895/how-to-use-fail2ban-for-nginx